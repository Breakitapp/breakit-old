script(type='text/javascript', src='http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js')
script(type='text/javascript', src='http://maps.google.com/maps/api/js?sensor=false')

script(type='text/javascript')
  
  var startPos;
  var latlng;
  var gcoder;
  var map;
  var infowindow = new google.maps.InfoWindow();
  
  $('document').ready(function() {
  if (navigator.geolocation) {
    console.log('Geolocation is supported!');
    navigator.geolocation.getCurrentPosition(function(position) {
      startPos = position;
      jQuery("#location_latitude").append(startPos.coords.latitude);
      jQuery("#location_longitude").append(startPos.coords.longitude);
      console.log(startPos.coords.latitude);
      console.log(startPos.coords.longitude);
      loadMap();
      loadAdd();
    });
  }});
  
  var loadMap = function() {
    var myOptions = {
      center: new google.maps.LatLng(startPos.coords.longitude, startPos.coords.latitude),
      zoom: 3,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById("map_canvas"),
      myOptions);
  };
  // $('document').ready(function() {loadMap();});
  
  var loadAdd = function() {
  gcoder = new google.maps.Geocoder();
  latlng = new google.maps.LatLng(startPos.coords.latitude, startPos.coords.longitude);
  gcoder.geocode({'latLng': latlng}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        if (results[1]) {
          map.setZoom(11);
          marker = new google.maps.Marker({
              position: latlng,
              map: map
          });
          infowindow.setContent(results[1].formatted_address);
          infowindow.open(map, marker);
        }
      } else {
        alert("Geocoder failed due to: " + status);
      }
    });

   }
   
div(id='map_canvas', style='height: 500px; width: 350px; background-color: #990000;')
    
form(name='input', method='post', action= '/splash_screen')
  input(type='email', name='email_field', value='email here');
  input(type='submit', name='submit_button', value='Submit');